// PART_NUMBER_QUERY
// INCLUDES TO_DELETE CLAUSE

CREATE DEFINER=`root`@`localhost` PROCEDURE `PART_NUMBER_QUERY`(IN partNo text, In pageSize int, In offsetNum int)
BEGIN
SELECT PART_HISTORY.PART_HISTORY_ID
	,CUSTOMERS.CUSTOMER_NAME
	,OPERATORS.OPERATOR_NAME
    ,PART_HISTORY.PART_NUMBER
    ,PART_HISTORY.QTY
    ,PART_HISTORY.DATE_RECEIVED
    ,PART_HISTORY.DATE_DUE
    ,PART_HISTORY.OPERATIONS
    ,PART_HISTORY.PURCHASE_ORDER_NUMBER
FROM ((CUSTOMERS 
	INNER JOIN PART_HISTORY ON CUSTOMERS.CUSTOMER_ID = PART_HISTORY.CUSTOMER_ID)
    INNER JOIN OPERATORS ON PART_HISTORY.OPERATOR_ID = OPERATORS.OPERATOR_ID)
    INNER JOIN JOBS ON OPERATORS.JOB_ID = JOBS.JOB_ID
WHERE (((PART_HISTORY.PART_NUMBER) LIKE partNo))
AND (PART_HISTORY.TO_DELETE = 0)
ORDER BY PART_HISTORY.DATE_DUE
LIMIT pageSize OFFSET offsetNum;
END


// PART_NUMBER_QUERY_COUNT
// INCLUDES TO_DELETE CLAUSE

CREATE DEFINER=`root`@`localhost` PROCEDURE `PART_NUMBER_QUERY_COUNT`(IN partNo text)
BEGIN
SELECT COUNT(*)
FROM ((CUSTOMERS 
	INNER JOIN PART_HISTORY ON CUSTOMERS.CUSTOMER_ID = PART_HISTORY.CUSTOMER_ID)
    INNER JOIN OPERATORS ON PART_HISTORY.OPERATOR_ID = OPERATORS.OPERATOR_ID)
    INNER JOIN JOBS ON OPERATORS.JOB_ID = JOBS.JOB_ID
WHERE (((PART_HISTORY.PART_NUMBER) LIKE partNo))
AND (PART_HISTORY.TO_DELETE = 0)
ORDER BY PART_HISTORY.DATE_DUE;
END